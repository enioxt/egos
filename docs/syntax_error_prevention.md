# EGOS Syntax Error Prevention Guidelines

## Overview

This document outlines the required practices and tools to prevent critical syntax errors from recurring in the EGOS codebase. These guidelines enforce high code quality standards while maintaining developer productivity.

## Required Pre-Commit Checks

All commits to the EGOS codebase **MUST** pass the following checks:

1. **Syntax Validation**

   ```bash
   python -m py_compile <changed_files>
   ```

2. **Critical Error Checking**

   ```bash
   ruff check --select E9,F821 <changed_files>
   ```

3. **Code Formatting**

   ```bash
   ruff format <changed_files>
   ```

## Setting Up Pre-Commit Hooks

### Installation

1. Install pre-commit:

   ```bash
   pip install pre-commit
   ```

2. Copy the `.pre-commit-config.yaml` file to your project root:

3. Install the git hook scripts:

   ```bash
   pre-commit install
   ```

### Pre-Commit Configuration

Create a `.pre-commit-config.yaml` file in the project root with the following content:

```yaml
repos:
-   repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
    -   id: trailing-whitespace
    -   id: end-of-file-fixer
    -   id: check-yaml
    -   id: check-added-large-files

-   repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.1.5
    hooks:
    -   id: ruff
        args: [--select, "E9,F821", --fix]
    -   id: ruff-format

-   repo: local
    hooks:
    -   id: python-syntax-check
        name: Python Syntax Check
        entry: python -m py_compile
        language: system
        files: \.py$
        pass_filenames: true
```

## Development Workflow

### 1. Regular Syntax Checking During Development

Developers should run syntax checks frequently during development:

```bash
# Quick syntax check
python -m py_compile <file.py>

# Check for critical errors
ruff check --select E9,F821 <file.py>

# Format code
ruff format <file.py>
```

### 2. AI-Generated Code Review Process

All code generated by AI assistants **MUST** be reviewed for correctness and syntax before integration:

1. **Initial Review**: Review the generated code for logical correctness and compatibility with the codebase
2. **Syntax Check**: Run `python -m py_compile` and `ruff check` on the generated code
3. **Test**: Write or run appropriate tests to verify functionality
4. **Format**: Apply `ruff format` to ensure consistent style
5. **Document Review**: Ensure proper docstrings and comments are included

### 3. Incremental Validation

For larger changes, validate incrementally:

```bash
# Validate specific module
python -m py_compile path/to/module.py

# Validate entire package
python -m compileall path/to/package
```

## Common Syntax Error Patterns to Avoid

| Pattern | Issue | Prevention |
|---------|-------|------------|
| Multiple docstrings | Causes parser confusion | Use a single docstring at the start of modules, classes, and functions |
| Scattered imports | Makes dependencies unclear | Group imports at the top of the file |
| Improper import resilience | Breaks module importing | Use the standard EGOS import resilience pattern exactly as documented |
| Mixed tabs and spaces | Indentation errors | Use spaces exclusively (4 spaces per indent level) |
| Unclosed brackets/parentheses | Syntax errors | Use an editor with bracket matching |
| Undefined variables | NameError at runtime | Ensure all variables are defined before use |

## Integration with IDEs

### VS Code

1. Install the Python extension
2. Configure Ruff linting in `.vscode/settings.json`:

   ```json
   {
     "python.linting.enabled": true,
     "python.linting.ruffEnabled": true,
     "editor.formatOnSave": true,
     "editor.codeActionsOnSave": {
       "source.fixAll.ruff": true
     }
   }
   ```

### PyCharm

1. Install the Ruff plugin
2. Enable "Format on Save" in Settings → Tools → Actions on Save

## Continuous Integration

The EGOS CI/CD pipeline includes these checks to prevent errors from being merged:

1. Syntax validation of all Python files
2. Ruff linting with critical error detection
3. Comprehensive error reports for reviewers

## References

- [EGOS Code Quality Standards](../../standards/code_quality.md)
- [Syntax Error Remediation Process](./syntax_error_remediation_process.md)
- [Ruff Documentation](https://beta.ruff.rs/docs/)
- [Pre-commit Documentation](https://pre-commit.com/)

@references:
- .windsurfrules
- CODE_OF_CONDUCT.md
- MQP.md
- README.md
- ROADMAP.md
- CROSSREF_STANDARD.md

@references(level=1):
  - docs/syntax_error_remediation_process.md






  - docs/syntax_error_prevention.md

- [MQP.md](mdc:../../MQP.md) - Master Quantum Prompt defining EGOS principles
- [ROADMAP.md](mdc:../../ROADMAP.md) - Project roadmap and planning